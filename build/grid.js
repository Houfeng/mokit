/*csd*/define(function(require,exports,module){"use strict";var d=require("./utils"),a=require("./jquery");function b(h,i){var f=0;var g=0;d.each(h,function(j){if(this.indexOf("%")>-1){h[j]=i*parseInt(this)/100;}else{h[j]=parseInt(this);}if(isNaN(h[j])){f++;}else{g+=h[j];}});if(f>0){var e=(i-g)/f;d.each(h,function(j){if(isNaN(h[j])){h[j]=e;}});}return h;}function c(i){i=a(i);var q=i.attr("data-grid-scroll-x");var p=i.attr("data-grid-scroll-y");var l=parseInt(i.attr("data-grid-rectify-x")||"0");var m=parseInt(i.attr("data-grid-rectify-y")||"0");var s={width:i.width(),height:i.height()};if(p&&i[0].scrollWidth>s.width){s.width=i[0].scrollWidth;}if(p&&i[0].scrollHeight>s.height){s.height=i[0].scrollHeight;}s.width+=l;s.height+=m;var h=i.attr("data-grid-cols");var n=i.attr("data-grid-rows");if(!h||!n){return;}h=b(h.split(","),s.width);n=b(n.split(","),s.height);var g=null;var o=i.attr("data-grid-scope");if(o=="all"){g=i.find("[data-role~=cell]");}else{g=i.children("[data-role~=cell]");}for(var k=0;k<n.length;k++){for(var e=0;e<h.length;e++){var f=a(g[h.length*k+e]);var t=h[e];t-=(parseInt(f.css("marginLeft"))+parseInt(f.css("marginRight")));t-=(parseInt(f.css("paddingLeft"))+parseInt(f.css("paddingRight")));t-=(parseInt(f.css("borderLeftWidth"))+parseInt(f.css("borderRightWidth")));var j=n[k];j-=(parseInt(f.css("marginTop"))+parseInt(f.css("marginBottom")));j-=(parseInt(f.css("paddingTop"))+parseInt(f.css("paddingBottom")));j-=(parseInt(f.css("borderTopWidth"))+parseInt(f.css("borderBottomWidth")));if(t==s.width){t="100%";}if(j==s.height){j="100%";}f.width(t).height(j);}}}exports.use=function(f){var e=f.find("[data-role~=grid]");var g=f.attr("data-role");if(g&&d.contains(g,"grid")){e.splice(0,0,f[0]);}e.each(function(){c(this);}).resize(function(){c(this);});a(window).resize(function(){e.each(function(){c(this);});});};});