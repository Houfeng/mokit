/*csd*/define(function(require,exports,module){"use strict";var h=require("./utils");var g=require("./store");var d=require("./event");var b=require("./console");var f=exports;var e=g.dataCache["$language"]=f.languages={};var c=null;f.languageChange=d.create(f,"languagechange");h.defineProperty(f,"currentName",{get:function(){c=c||g.local.get("mokit://language/current-name");return c;},set:function(i){c=i;return c;}},true);var a=null;h.defineProperty(exports,"current",{get:function(){return a;},set:function(i){return a=i;}},true);h.defineProperty(f,"defaultName",{get:function(){var i=(navigator.language||"").toLowerCase();if(e[i]){return i;}else{return Object.getOwnPropertyNames(e)[0];}}},true);f.addLanguage=function(i,j){h.each(i,function(k){e[k]=(j&&j.resovleUri)?j.resovleUri(this):this;});};f.setLanguage=function(k,i){if(!h.isString(k)){return;}var j=e[k];if(j){require(j,function(l){f.current(l);f.currentName(k);f.languageChange.trigger(k,l);if(i){i(k,l);}});}else{b.error('language "'+k+'" not found.');}};f.save=function(){return g.local.set("mokit://language/current-name",c);};f.clear=function(){return g.local.set("mokit://language/current-name","");};});