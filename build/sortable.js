/*csd*/define(function(require,exports,module){"use strict";var a=require("./jquery");var e=null;var c=null;var h=null;var g=null;var b=null;var d={x:30,y:30};var f=null;a(document.body).bind("vmousedown",function(i){h={x:i.pageX,y:i.pageY};}).bind("vmousemove",function(i){if(!e||!c||!h||!g||!b){return;}var j={left:g.left+i.pageX-h.x,top:g.top+i.pageY-h.y};c.css({"left":j.left,"top":j.top});e.each(function(){if(this==c[0]||this==b[0]){return;}var k=a(this);var l=k.offset();if(j.left>l.left-d.x&&j.left<l.left+d.x&&j.top>l.top-d.y&&j.top<l.top+d.y){b.remove();if(j.left<l.left||j.top<l.top){k.before(b);}else{k.after(b);}}});}).bind("vmouseup",function(i){if(!c||!b){return;}c.css({"position":"","left":"","top":"","zIndex":0});b.replaceWith(c);if(f&&f.onEnd){f.onEnd(c);}c=null;h=null;g=null;b=null;e=null;f=null;});exports.use=function(i,j){i.attr("draggable",false);i.find("a,img").attr("draggable",false);j=j||{};j.event=j.event||"vmousedown";i.bind(j.event,function(k){f=j;e=i;c=a(this);d={x:c.outerWidth()/5,y:c.outerHeight()/5};g=c.offset();if(b){b.remove();}b=c.clone();b.width(g.width).height(g.height);b.css({"backgroundColor":"#eee","solid":"solid 1px #aaa;"}).html("");c.css({"position":"absolute","zIndex":99999,"left":g.left,"top":g.top});c.before(b);if(j.onBegin){j.onBegin(c);}});};});