/*csd*/define(function(require,exports,module){"use strict";var a=require("./event");var h=require("./utils");var e=exports;var g=("ontouchstart" in document);var f=g?"touchstart":"mousedown";var d=g?"touchmove":"mousemove";var b=g?"touchend":"mouseup";e.option={swipeDurationThreshold:1000,swipeHorizontalDistanceThreshold:25,swipeVerticalDistanceThreshold:45,holdDurationThreshold:1000,dblDurationThreshold:450,scrollSupressionThreshold:25};var c="tap,taphold,dbltap,swipe,swipeup,swiperight,swipedown,swipeleft,pointdown,pointmove,pointup";a.register(c,{on:function(j,k,i,l){if(!h.isFunction(i)){return;}i.touchstart=i.touchstart||function(m){var n=m.changedTouches?m.changedTouches[0]:m;i.startPoint=i.endPoint={"x":n.pageX,"y":n.pageY,"timeStamp":m.timeStamp,"point":n};if(k=="taphold"){i.createHoldHandler(m);}if(k=="pointdown"){h.copy(i.startPoint,m);j.call("pointdown",m);j.isPointDown=true;}};i.createHoldHandler=i.createHoldHandler||function(m){if(!i.holdTimer&&!i.holdHandler){var n=e.option;i.holdHandler=function(){m.taphold=true;j.call("taphold",m);};i.holdTimer=setTimeout(function(){if(i.holdHandler){i.holdHandler();}},n.holdDurationThreshold);}};i.clearHoldHandler=i.clearHoldHandler||function(){if(i.holdTimer){clearTimeout(i.holdTimer);i.holdTimer=null;i.holdHandler=null;}};i.getTouchInfo=function(m){var p=m.changedTouches?m.changedTouches[0]:m;i.endPoint={"x":p.pageX,"y":p.pageY,"timeStamp":m.timeStamp,"point":p};var o=e.option;var n={};n.timeStamp=i.endPoint?i.endPoint.timeStamp:null;n.existStartAndStop=i.endPoint&&i.startPoint;n.horizontalDistance=n.existStartAndStop?i.endPoint.x-i.startPoint.x:0;n.verticalDistance=n.existStartAndStop?i.endPoint.y-i.startPoint.y:0;n.horizontalDistanceValue=Math.abs(n.horizontalDistance);n.verticalDistanceVlaue=Math.abs(n.verticalDistance);n.isHorizontal=n.horizontalDistanceValue>=n.verticalDistanceVlaue;n.isVertical=!n.sHorizontal;n.isSwipeMove=n.horizontalDistanceValue>=o.swipeHorizontalDistanceThreshold||n.verticalDistanceVlaue>=o.swipeVerticalDistanceThreshold;n.isSwipeTime=n.existStartAndStop?i.endPoint.timeStamp-i.startPoint.timeStamp<=o.swipeDurationThreshold:true;n.isHoldTime=n.existStartAndStop?i.endPoint.timeStamp-i.startPoint.timeStamp>=o.holdDurationThreshold:false;if(n.isHorizontal&&n.horizontalDistance>0){n.direction="right";}else{if(n.isHorizontal&&n.horizontalDistance<0){n.direction="left";}else{if(n.isVertical&&n.verticalDistance>0){n.direction="down";}else{if(n.isVertical&&n.verticalDistance<0){n.direction="up";}}}}return n;};i.touchmove=i.touchmove||function(m){var n=i.getTouchInfo(m);if(n.isSwipeMove){i.clearHoldHandler();}var o=false;if(j.isPointDown&&k=="pointmove"){h.copy(i.endPoint,m);j.call("pointmove",m);o=true;}if((k=="swipe")||(k=="swipe"+n.direction)){o=true;}if(o){return false;}};i.done=i.done||function(m){i.clearHoldHandler();var n=i.getTouchInfo(m);if(k=="pointup"){h.copy(i.endPoint,m);j.call("pointup",m);j.isPointDown=false;}if(n.isSwipeTime&&n.isSwipeMove){m.swipe=true;m.direction=n.direction;if(k=="swipe"){j.call("swipe",m);}if(k=="swipe"+m.direction){j.call("swipe"+m.direction,m);}}else{if(n.isSwipeTime&&!n.isSwipeMove&&!n.isHoldTime){if(k=="tap"){j.call("tap",m);}if(k=="dbltap"){var o=e.option;m.dbltap=i.PreTapTime&&n.timeStamp-i.PreTapTime<=o.dblDurationThreshold;if(m.dbltap){j.call("dbltap",m);i.PreTapTime=null;}else{i.PreTapTime=i.endPoint.timeStamp;}}}}};j.on(f,i.touchstart);j.on(d,i.touchmove);j.on(b,i.done);},off:function(j,k,i,l){if(h.isFunction(i)){if(h.isFunction(i.touchstart)){j.off(f,i.touchstart);}if(h.isFunction(i.touchmove)){j.off(d,i.touchmove);}if(h.isFunction(i.done)){j.off(b,i.done);}}}});});