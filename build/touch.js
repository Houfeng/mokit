/*csd*/define(function(require,exports,module){"use strict";var a=require("mokit/event");var d=require("mokit/utils");var c=exports;c.option={swipe:{durationThreshold:1000,horizontalDistanceThreshold:25,verticalDistanceThreshold:45},tap:{holdDurationThreshold:1000,durationThreshold:450}};var b="tap,taphold,dbltap,swipe,swipeup,swiperight,swipedown,swipeleft";a.register(b,function(g,h,f,i){g.on("touchstart",function(j){var k=j.changedTouches[0]||{};g.startPoint=g.endPoint={x:k.pageX,y:k.pageY,timeStamp:j.timeStamp};if(h=="taphold"){g.createHoldHandler(j);}return false;});g.createHoldHandler=function(j){if(!g.holdTimer&&!g.holdHandler){var k=c.option.tap.holdDurationThreshold;g.holdHandler=function(){j.taphold=true;g.call("taphold",j);};g.holdTimer=setTimeout(function(){if(g.holdHandler){g.holdHandler();}},k);}};g.clearHoldHandler=function(){if(g.holdTimer){clearTimeout(g.holdTimer);g.holdTimer=null;g.holdHandler=null;}};g.on("touchmove",function(){if(h=="taphold"){var n=event.changedTouches[0]||{};g.endPoint={x:n.pageX,y:n.pageY,timeStamp:event.timeStamp};var k=c.option.swipe.horizontalDistanceThreshold;var p=c.option.swipe.horizontalDistanceThreshold;var j=g.endPoint.x-g.startPoint.x;var o=g.endPoint.y-g.startPoint.y;var l=Math.abs(j);var q=Math.abs(o);var m=l>=k||q>=p;if(m){g.clearHoldHandler();}}return false;});g.on("scroll",function(){return false;});g.on("contextmenu",function(){return false;});var e=function(j){g.clearHoldHandler();var s=j.changedTouches[0]||{};g.endPoint={x:s.pageX,y:s.pageY,timeStamp:j.timeStamp};var l=c.option.swipe.horizontalDistanceThreshold;var u=c.option.swipe.horizontalDistanceThreshold;var k=g.endPoint.x-g.startPoint.x;var t=g.endPoint.y-g.startPoint.y;var m=Math.abs(k);var v=Math.abs(t);var o=m>=v;var r=!o;var p=m>=l||v>=u;var q=g.endPoint.timeStamp-g.startPoint.timeStamp<=c.option.swipe.durationThreshold;var n=g.endPoint.timeStamp-g.startPoint.timeStamp>=c.option.tap.holdDurationThreshold;if(q&&p){j.swipe=true;if(o&&k>0){j.direction="right";}else{if(o&&k<0){j.direction="left";}else{if(r&&t>0){j.direction="down";}else{if(r&&t<0){j.direction="up";}}}}if(h=="swipe"){g.call("swipe",j);}if(h=="swipe"+j.direction){g.call("swipe"+j.direction,j);}}else{if(q&&!p&&!n){if(h=="tap"){g.call("tap",j);}if(h=="dbltap"){j.dbltap=g.PreTapTime&&g.endPoint.timeStamp-g.PreTapTime<=c.option.tap.durationThreshold;if(j.dbltap){g.call("dbltap",j);g.PreTapTime=null;}else{g.PreTapTime=g.endPoint.timeStamp;}}}}};g.on("touchend",e);g.on("touchcancel",e);});});