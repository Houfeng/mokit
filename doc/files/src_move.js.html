<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/move.js - Mokit API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../logo.png" title="Mokit API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: v2.0 Beta 34</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Ajax.html">Ajax</a></li>
            
                <li><a href="../classes/App.html">App</a></li>
            
                <li><a href="../classes/Base64.html">Base64</a></li>
            
                <li><a href="../classes/Class.html">Class</a></li>
            
                <li><a href="../classes/Console.html">Console</a></li>
            
                <li><a href="../classes/Context.html">Context</a></li>
            
                <li><a href="../classes/Controller.html">Controller</a></li>
            
                <li><a href="../classes/Event.html">Event</a></li>
            
                <li><a href="../classes/Grid.html">Grid</a></li>
            
                <li><a href="../classes/Json.html">Json</a></li>
            
                <li><a href="../classes/Language.html">Language</a></li>
            
                <li><a href="../classes/Mask.html">Mask</a></li>
            
                <li><a href="../classes/Model.html">Model</a></li>
            
                <li><a href="../classes/Move.html">Move</a></li>
            
                <li><a href="../classes/Navigation.html">Navigation</a></li>
            
                <li><a href="../classes/Route.html">Route</a></li>
            
                <li><a href="../classes/Sortable.html">Sortable</a></li>
            
                <li><a href="../classes/Store.html">Store</a></li>
            
                <li><a href="../classes/Style.html">Style</a></li>
            
                <li><a href="../classes/Task.html">Task</a></li>
            
                <li><a href="../classes/Utils.html">Utils</a></li>
            
                <li><a href="../classes/View.html">View</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/mokit.html">mokit</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/move.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*!
 * move
 * Copyright(c) 2011 TJ Holowaychuk &lt;tj@vision-media.ca&gt;
 * MIT Licensed
 */
/**
 * Move动画模块
 * @class Move
 */
(function(exports) {
  &quot;Move:nomunge&quot;;
  //不能运行在严格模式下 &quot;use strict&quot;;

  /**
   * Computed style.
   */

  var current = window.getComputedStyle || window.currentStyle;

  /**
   * Map of prop -&gt; type for numeric values.
   */

  var map = {
    &#x27;top&#x27;: &#x27;px&#x27;,
    &#x27;bottom&#x27;: &#x27;px&#x27;,
    &#x27;left&#x27;: &#x27;px&#x27;,
    &#x27;right&#x27;: &#x27;px&#x27;,
    &#x27;width&#x27;: &#x27;px&#x27;,
    &#x27;height&#x27;: &#x27;px&#x27;,
    &#x27;font-size&#x27;: &#x27;px&#x27;,
    &#x27;margin&#x27;: &#x27;px&#x27;,
    &#x27;margin-top&#x27;: &#x27;px&#x27;,
    &#x27;margin-bottom&#x27;: &#x27;px&#x27;,
    &#x27;margin-left&#x27;: &#x27;px&#x27;,
    &#x27;margin-right&#x27;: &#x27;px&#x27;,
    &#x27;padding&#x27;: &#x27;px&#x27;,
    &#x27;padding-top&#x27;: &#x27;px&#x27;,
    &#x27;padding-bottom&#x27;: &#x27;px&#x27;,
    &#x27;padding-left&#x27;: &#x27;px&#x27;,
    &#x27;padding-right&#x27;: &#x27;px&#x27;
  };

  /**
   * Initialize a &#x60;Move&#x60; instance with the given &#x60;selector&#x60;.
   *
   * @param {String} selector
   * @return {Move}
   * @api public
   * @method move
   */

  exports.move = function(selector) {
    return new Move(move.select(selector));
  };

  /**
   * Library version.
   */

  exports.move.version = &#x27;0.0.3&#x27;;

  /**
   * Defaults.
   *
   *   &#x60;duration&#x60; - default duration of 500ms
   * @property {Object} defaults
   */

  move.defaults = {
    duration: 500
  };

  /**
   * Easing functions.
   */

  move.ease = {
    &#x27;in&#x27;: &#x27;ease-in&#x27;,
    &#x27;out&#x27;: &#x27;ease-out&#x27;,
    &#x27;in-out&#x27;: &#x27;ease-in-out&#x27;,
    &#x27;snap&#x27;: &#x27;cubic-bezier(0,1,.5,1)&#x27;,
    &#x27;linear&#x27;: &#x27;cubic-bezier(0.250, 0.250, 0.750, 0.750)&#x27;,
    &#x27;ease-in-quad&#x27;: &#x27;cubic-bezier(0.550, 0.085, 0.680, 0.530)&#x27;,
    &#x27;ease-in-cubic&#x27;: &#x27;cubic-bezier(0.550, 0.055, 0.675, 0.190)&#x27;,
    &#x27;ease-in-quart&#x27;: &#x27;cubic-bezier(0.895, 0.030, 0.685, 0.220)&#x27;,
    &#x27;ease-in-quint&#x27;: &#x27;cubic-bezier(0.755, 0.050, 0.855, 0.060)&#x27;,
    &#x27;ease-in-sine&#x27;: &#x27;cubic-bezier(0.470, 0.000, 0.745, 0.715)&#x27;,
    &#x27;ease-in-expo&#x27;: &#x27;cubic-bezier(0.950, 0.050, 0.795, 0.035)&#x27;,
    &#x27;ease-in-circ&#x27;: &#x27;cubic-bezier(0.600, 0.040, 0.980, 0.335)&#x27;,
    &#x27;ease-in-back&#x27;: &#x27;cubic-bezier(0.600, -0.280, 0.735, 0.045)&#x27;,
    &#x27;ease-out-quad&#x27;: &#x27;cubic-bezier(0.250, 0.460, 0.450, 0.940)&#x27;,
    &#x27;ease-out-cubic&#x27;: &#x27;cubic-bezier(0.215, 0.610, 0.355, 1.000)&#x27;,
    &#x27;ease-out-quart&#x27;: &#x27;cubic-bezier(0.165, 0.840, 0.440, 1.000)&#x27;,
    &#x27;ease-out-quint&#x27;: &#x27;cubic-bezier(0.230, 1.000, 0.320, 1.000)&#x27;,
    &#x27;ease-out-sine&#x27;: &#x27;cubic-bezier(0.390, 0.575, 0.565, 1.000)&#x27;,
    &#x27;ease-out-expo&#x27;: &#x27;cubic-bezier(0.190, 1.000, 0.220, 1.000)&#x27;,
    &#x27;ease-out-circ&#x27;: &#x27;cubic-bezier(0.075, 0.820, 0.165, 1.000)&#x27;,
    &#x27;ease-out-back&#x27;: &#x27;cubic-bezier(0.175, 0.885, 0.320, 1.275)&#x27;,
    &#x27;ease-out-quad&#x27;: &#x27;cubic-bezier(0.455, 0.030, 0.515, 0.955)&#x27;,
    &#x27;ease-out-cubic&#x27;: &#x27;cubic-bezier(0.645, 0.045, 0.355, 1.000)&#x27;,
    &#x27;ease-in-out-quart&#x27;: &#x27;cubic-bezier(0.770, 0.000, 0.175, 1.000)&#x27;,
    &#x27;ease-in-out-quint&#x27;: &#x27;cubic-bezier(0.860, 0.000, 0.070, 1.000)&#x27;,
    &#x27;ease-in-out-sine&#x27;: &#x27;cubic-bezier(0.445, 0.050, 0.550, 0.950)&#x27;,
    &#x27;ease-in-out-expo&#x27;: &#x27;cubic-bezier(1.000, 0.000, 0.000, 1.000)&#x27;,
    &#x27;ease-in-out-circ&#x27;: &#x27;cubic-bezier(0.785, 0.135, 0.150, 0.860)&#x27;,
    &#x27;ease-in-out-back&#x27;: &#x27;cubic-bezier(0.680, -0.550, 0.265, 1.550)&#x27;
  };

  /**
   * Default element selection utilized by &#x60;move(selector)&#x60;.
   *
   * Override to implement your own selection, for example
   * with jQuery one might write:
   *
   *     move.select = function(selector) {
   *       return jQuery(selector).get(0);
   *     };
   *
   * @param {Object|String} selector
   * @return {Element}
   * @api public
   * @method selector
   */

  move.select = function(selector) {
    if (&#x27;string&#x27; != typeof selector) return selector;
    return document.getElementById(selector) || document.querySelectorAll(selector)[0];
  };

  /**
   * EventEmitter.
   */

  function EventEmitter() {
    this.callbacks = {};
  }

  /**
   * Listen on the given &#x60;event&#x60; with &#x60;fn&#x60;.
   *
   * @param {String} event
   * @param {Function} fn
   * @method on
   */

  EventEmitter.prototype.on = function(event, fn) {
    (this.callbacks[event] = this.callbacks[event] || [])
      .push(fn);
    return this;
  };

  /**
   * Emit &#x60;event&#x60; with the given args.
   *
   * @param {String} event
   * @param {Mixed} ...
   * @method emit
   */

  EventEmitter.prototype.emit = function(event) {
    var args = Array.prototype.slice.call(arguments, 1),
      callbacks = this.callbacks[event],
      len;

    if (callbacks) {
      len = callbacks.length;
      for (var i = 0; i &lt; len; ++i) {
        callbacks[i].apply(this, args)
      }
    }

    return this;
  };

  /**
   * Initialize a new &#x60;Move&#x60; with the given &#x60;el&#x60;.
   *
   * @param {Element} el
   * @api public
   * @method Move
   */

  exports.Move = function Move(el) {
    if (!(this instanceof Move)) return new Move(el);
    EventEmitter.call(this);
    this.el = el;
    this._props = {};
    this._rotate = 0;
    this._transitionProps = [];
    this._transforms = [];
    this.duration(move.defaults.duration)
  };

  /**
   * Inherit from &#x60;EventEmitter.prototype&#x60;.
   */

  Move.prototype = new EventEmitter;
  Move.prototype.constructor = Move;

  /**
   * Buffer &#x60;transform&#x60;.
   *
   * @param {String} transform
   * @return {Move} for chaining
   * @api private
   */

  Move.prototype.transform = function(transform) {
    this._transforms.push(transform);
    return this;
  };

  /**
   * Skew &#x60;x&#x60; and &#x60;y&#x60;.
   *
   * @param {Number} x
   * @param {Number} y
   * @return {Move} for chaining
   * @api public
   * @method skew
   */

  Move.prototype.skew = function(x, y) {
    y = y || 0;
    return this.transform(&#x27;skew(&#x27; + x + &#x27;deg, &#x27; + y + &#x27;deg)&#x27;);
  };

  /**
   * Skew x by &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method skewX
   */

  Move.prototype.skewX = function(n) {
    return this.transform(&#x27;skewX(&#x27; + n + &#x27;deg)&#x27;);
  };

  /**
   * Skew y by &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method skewY
   */

  Move.prototype.skewY = function(n) {
    return this.transform(&#x27;skewY(&#x27; + n + &#x27;deg)&#x27;);
  };

  /**
   * Translate &#x60;x&#x60; and &#x60;y&#x60; axis.
   *
   * @param {Number} x
   * @param {Number} y
   * @return {Move} for chaining
   * @api public
   * @method translate
   */

  Move.prototype.translate =
    Move.prototype.to = function(x, y) {
      y = y || 0;
      return this.transform(&#x27;translate(&#x27; + x + &#x27;px, &#x27; + y + &#x27;px)&#x27;);
  };

  /**
   * Translate on the x axis to &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method translateX
   */

  Move.prototype.translateX =
    Move.prototype.x = function(n) {
      return this.transform(&#x27;translateX(&#x27; + n + &#x27;px)&#x27;);
  };

  /**
   * Translate on the y axis to &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method translateY
   */

  Move.prototype.translateY =
    Move.prototype.y = function(n) {
      return this.transform(&#x27;translateY(&#x27; + n + &#x27;px)&#x27;);
  };

  /**
   * Scale the x and y axis by &#x60;x&#x60;, or
   * individually scale &#x60;x&#x60; and &#x60;y&#x60;.
   *
   * @param {Number} x
   * @param {Number} y
   * @return {Move} for chaining
   * @api public
   * @method scale
   */

  Move.prototype.scale = function(x, y) {
    y = null == y ? x : y;
    return this.transform(&#x27;scale(&#x27; + x + &#x27;, &#x27; + y + &#x27;)&#x27;);
  };

  /**
   * Scale x axis by &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method scaleX
   */

  Move.prototype.scaleX = function(n) {
    return this.transform(&#x27;scaleX(&#x27; + n + &#x27;)&#x27;)
  };

  /**
   * Scale y axis by &#x60;n&#x60;.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method scaleY
   */

  Move.prototype.scaleY = function(n) {
    return this.transform(&#x27;scaleY(&#x27; + n + &#x27;)&#x27;)
  };

  /**
   * Rotate &#x60;n&#x60; degrees.
   *
   * @param {Number} n
   * @return {Move} for chaining
   * @api public
   * @method rotate
   */

  Move.prototype.rotate = function(n) {
    return this.transform(&#x27;rotate(&#x27; + n + &#x27;deg)&#x27;);
  };

  /**
   * Set transition easing function to to &#x60;fn&#x60; string.
   *
   * When:
   *
   *   - null &quot;ease&quot; is used
   *   - &quot;in&quot; &quot;ease-in&quot; is used
   *   - &quot;out&quot; &quot;ease-out&quot; is used
   *   - &quot;in-out&quot; &quot;ease-in-out&quot; is used
   *
   * @param {String} fn
   * @return {Move} for chaining
   * @api public
   * @method ease
   */

  Move.prototype.ease = function(fn) {
    fn = move.ease[fn] || fn || &#x27;ease&#x27;;
    return this.setVendorProperty(&#x27;transition-timing-function&#x27;, fn);
  };

  /**
   * Set animation properties
   *
   * @param {String} name
   * @param {Object} props
   * @return {Move} for chaining
   * @api public
   * @method animate
   */

  Move.prototype.animate = function(name, props) {
    for (var i in props) {
      if (props.hasOwnProperty(i)) {
        this.setVendorProperty(&#x27;animation-&#x27; + i, props[i])
      }
    }
    return this.setVendorProperty(&#x27;animation-name&#x27;, name);
  }

  /**
   * Set duration to &#x60;n&#x60;.
   *
   * @param {Number|String} n
   * @return {Move} for chaining
   * @api public
   * @method duration
   */

  Move.prototype.duration = function(n) {
    n = this._duration = &#x27;string&#x27; == typeof n ? parseFloat(n) * 1000 : n;
    return this.setVendorProperty(&#x27;transition-duration&#x27;, n + &#x27;ms&#x27;);
  };

  /**
   * Delay the animation by &#x60;n&#x60;.
   *
   * @param {Number|String} n
   * @return {Move} for chaining
   * @api public
   * @method delay
   */

  Move.prototype.delay = function(n) {
    n = &#x27;string&#x27; == typeof n ? parseFloat(n) * 1000 : n;
    return this.setVendorProperty(&#x27;transition-delay&#x27;, n + &#x27;ms&#x27;);
  };

  /**
   * Set &#x60;prop&#x60; to &#x60;val&#x60;, deferred until &#x60;.end()&#x60; is invoked.
   *
   * @param {String} prop
   * @param {String} val
   * @return {Move} for chaining
   * @api public
   * @method setProperty
   */

  Move.prototype.setProperty = function(prop, val) {
    this._props[prop] = val;
    return this;
  };

  /**
   * Set a vendor prefixed &#x60;prop&#x60; with the given &#x60;val&#x60;.
   *
   * @param {String} prop
   * @param {String} val
   * @return {Move} for chaining
   * @api public
   * @method setVendorProperty
   */

  Move.prototype.setVendorProperty = function(prop, val) {
    this.setProperty(&#x27;-webkit-&#x27; + prop, val);
    this.setProperty(&#x27;-moz-&#x27; + prop, val);
    this.setProperty(&#x27;-ms-&#x27; + prop, val);
    this.setProperty(&#x27;-o-&#x27; + prop, val);
    return this;
  };

  /**
   * Set &#x60;prop&#x60; to &#x60;value&#x60;, deferred until &#x60;.end()&#x60; is invoked
   * and adds the property to the list of transition props.
   *
   * @param {String} prop
   * @param {String} val
   * @return {Move} for chaining
   * @api public
   * @method set
   */

  Move.prototype.set = function(prop, val) {
    this.transition(prop);
    if (&#x27;number&#x27; == typeof val &amp;&amp; map[prop]) val += map[prop];
    this._props[prop] = val;
    return this;
  };

  /**
   * Increment &#x60;prop&#x60; by &#x60;val&#x60;, deferred until &#x60;.end()&#x60; is invoked
   * and adds the property to the list of transition props.
   *
   * @param {String} prop
   * @param {Number} val
   * @return {Move} for chaining
   * @api public
   * @method add
   */

  Move.prototype.add = function(prop, val) {
    if (!current) return;
    var self = this;
    return this.on(&#x27;start&#x27;, function() {
      var curr = parseInt(self.current(prop), 10);
      self.set(prop, curr + val + &#x27;px&#x27;);
    });
  };

  /**
   * Decrement &#x60;prop&#x60; by &#x60;val&#x60;, deferred until &#x60;.end()&#x60; is invoked
   * and adds the property to the list of transition props.
   *
   * @param {String} prop
   * @param {Number} val
   * @return {Move} for chaining
   * @api public
   * @method sub
   */

  Move.prototype.sub = function(prop, val) {
    if (!current) return;
    var self = this;
    return this.on(&#x27;start&#x27;, function() {
      var curr = parseInt(self.current(prop), 10);
      self.set(prop, curr - val + &#x27;px&#x27;);
    });
  };

  /**
   * Get computed or &quot;current&quot; value of &#x60;prop&#x60;.
   *
   * @param {String} prop
   * @return {String}
   * @api public
   * @method current
   */

  Move.prototype.current = function(prop) {
    return current(this.el).getPropertyValue(prop);
  };

  /**
   * Add &#x60;prop&#x60; to the list of internal transition properties.
   *
   * @param {String} prop
   * @return {Move} for chaining
   * @api private
   * @method transition
   */

  Move.prototype.transition = function(prop) {
    if (!this._transitionProps.indexOf(prop)) return this;
    this._transitionProps.push(prop);
    return this;
  };

  /**
   * Commit style properties, aka apply them to &#x60;el.style&#x60;.
   *
   * @return {Move} for chaining
   * @see Move#end()
   * @api private
   * @method applyProperties
   */

  Move.prototype.applyProperties = function() {
    var props = this._props,
      el = this.el;

    for (var prop in props) {
      if (props.hasOwnProperty(prop)) {
        el.style.setProperty(prop, props[prop], &#x27;&#x27;);
      }
    }

    return this;
  };

  /**
   * Re-select element via &#x60;selector&#x60;, replacing
   * the current element.
   *
   * @param {String} selector
   * @return {Move} for chaining
   * @api public
   * @method move
   */

  Move.prototype.move =
    Move.prototype.select = function(selector) {
      this.el = move.select(selector);
      return this;
  };

  /**
   * Defer the given &#x60;fn&#x60; until the animation
   * is complete. &#x60;fn&#x60; may be one of the following:
   *
   *   - a function to invoke
   *   - an instanceof &#x60;Move&#x60; to call &#x60;.end()&#x60;
   *   - nothing, to return a clone of this &#x60;Move&#x60; instance for chaining
   *
   * @param {Function|Move} fn
   * @return {Move} for chaining
   * @api public
   * @method then
   */

  Move.prototype.then = function(fn) {
    // invoke .end()
    if (fn instanceof Move) {
      this.on(&#x27;end&#x27;, function() {
        fn.end();
      });
      // callback
    } else if (&#x27;function&#x27; == typeof fn) {
      this.on(&#x27;end&#x27;, fn);
      // chain
    } else {
      var clone = new Move(this.el);
      clone._transforms = this._transforms.slice(0);
      this.then(clone);
      clone.parent = this;
      return clone;
    }

    return this;
  };

  /**
   * Pop the move context.
   *
   * @return {Move} parent Move
   * @api public
   * @method pop
   */

  Move.prototype.pop = function() {
    return this.parent;
  };

  /**
   * Start animation, optionally calling &#x60;fn&#x60; when complete.
   *
   * @param {Function} fn
   * @return {Move} for chaining
   * @api public
   * @method end
   */

  Move.prototype.end = function(fn) {
    var self = this;

    // emit &quot;start&quot; event
    this.emit(&#x27;start&#x27;);

    // transforms
    if (this._transforms.length) {
      this.setVendorProperty(&#x27;transform&#x27;, this._transforms.join(&#x27; &#x27;));
    }

    // transition properties
    this.setVendorProperty(&#x27;transition-properties&#x27;, this._transitionProps.join(&#x27;, &#x27;));
    this.applyProperties();

    // callback given
    if (fn) this.then(fn);

    // emit &quot;end&quot; when complete
    setTimeout(function() {
      self.emit(&#x27;end&#x27;);
    }, this._duration);

    return this;
  };

  //兼容AMD模块
  if (typeof define === &#x27;function&#x27; &amp;&amp; define.amd) {
    define(&#x27;move&#x27;, [], function() {
      return exports.move;
    });
  }

})(this);
//
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
